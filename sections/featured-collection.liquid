{%- liquid
  assign collection = section.settings.collection
  if collection == blank
    assign products_to_show = 10
  else
    assign products_to_show = section.settings.products_to_show
  endif
-%}

<section class="section section--cream" id="collection">
  <div class="container">
    <div class="section__header">
      {%- if section.settings.eyebrow != blank -%}
        <span class="section__eyebrow">{{ section.settings.eyebrow }}</span>
      {%- endif -%}
      <h2 class="section__title">{{ section.settings.heading }}</h2>
      {%- if section.settings.description != blank -%}
        <p class="section__description">{{ section.settings.description }}</p>
      {%- endif -%}
    </div>

    <div class="featured-grid">
      {%- if collection != blank -%}
        {%- for product in collection.products limit: products_to_show -%}
          {% render 'product-card', product: product %}
        {%- endfor -%}
      {%- else -%}
        {% comment %} Placeholder products for preview {% endcomment %}
        {%- assign placeholder_names = "Noir Absolu,Amber Elixir,Rose Oud,Bergamot Mist,Velvet Tonka,Sandalwood Dreams,Iris Midnight,Cedar Smoke,Jasmine Imperial,Leather & Spice" | split: "," -%}
        {%- assign placeholder_notes = "Dark chocolate, Oud, Leather|Amber, Vanilla, Benzoin|Bulgarian Rose, Oud, Saffron|Bergamot, White Tea, Musk|Tonka Bean, Almond, Praline|Sandalwood, Cedarwood, Vetiver|Iris, Violet, Suede|Cedar, Birch, Smoke|Jasmine, Tuberose, Gardenia|Leather, Cardamom, Black Pepper" | split: "|" -%}
        {%- for i in (1..10) -%}
          {%- assign index = forloop.index0 -%}
          <article class="product-card">
            <a href="#" class="product-card__link">
              <div class="product-card__image">
                {%- if forloop.index == 1 -%}
                  <span class="product-card__badge product-card__badge--new">New</span>
                {%- elsif forloop.index == 3 -%}
                  <span class="product-card__badge product-card__badge--bestseller">Bestseller</span>
                {%- endif -%}
                <div class="product-card__placeholder">
                  <svg viewBox="0 0 60 100" fill="none" stroke="currentColor" stroke-width="1">
                    <rect x="15" y="25" width="30" height="65" rx="3"/>
                    <rect x="20" y="10" width="20" height="15"/>
                    <rect x="25" y="2" width="10" height="8" rx="2"/>
                    <text x="30" y="62" text-anchor="middle" font-size="8" fill="currentColor" stroke="none">BN</text>
                  </svg>
                </div>
                <div class="product-card__overlay">
                  <span class="product-card__quick-view">View Details</span>
                </div>
              </div>

              <div class="product-card__info">
                <span class="product-card__brand">Basenotes Atelier</span>
                <h3 class="product-card__title">{{ placeholder_names[index] }}</h3>
                <p class="product-card__notes">{{ placeholder_notes[index] }}</p>
                <div class="product-card__footer">
                  <span class="product-card__price">$20<span class="product-card__price-period">/mo</span></span>
                </div>
              </div>
            </a>
            <button class="product-card__add-btn" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14M5 12h14"/>
              </svg>
              Add to Queue
            </button>
          </article>
        {%- endfor -%}
      {%- endif -%}
    </div>

    {%- if section.settings.show_view_all and collection != blank -%}
      <div class="text-center mt-5">
        <a href="{{ collection.url }}" class="btn btn--primary btn--large">
          View All Fragrances
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

<style>
  .featured-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: var(--spacing-lg);
  }

  @media (max-width: 1200px) {
    .featured-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  @media (max-width: 992px) {
    .featured-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media (max-width: 768px) {
    .featured-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-md);
    }
  }

  @media (max-width: 480px) {
    .featured-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Product Card Styles for placeholders */
  .featured-grid .product-card {
    position: relative;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .featured-grid .product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
  }

  .featured-grid .product-card__link {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .featured-grid .product-card__image {
    position: relative;
    aspect-ratio: 3 / 4;
    background: var(--color-background-secondary);
    overflow: hidden;
  }

  .featured-grid .product-card__placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text-muted);
  }

  .featured-grid .product-card__placeholder svg {
    width: 60%;
    max-width: 80px;
    opacity: 0.5;
  }

  .featured-grid .product-card__badge {
    position: absolute;
    top: 12px;
    left: 12px;
    padding: 4px 10px;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: 4px;
    z-index: 2;
  }

  .featured-grid .product-card__badge--new,
  .featured-grid .product-card__badge--bestseller {
    background: var(--color-secondary);
    color: var(--color-primary);
  }

  .featured-grid .product-card__overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.2s;
  }

  .featured-grid .product-card:hover .product-card__overlay {
    opacity: 1;
  }

  .featured-grid .product-card__quick-view {
    padding: 10px 20px;
    background: white;
    color: var(--color-primary);
    font-size: 0.8125rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: 4px;
  }

  .featured-grid .product-card__info {
    padding: 1rem;
    text-align: center;
  }

  .featured-grid .product-card__brand {
    display: block;
    font-size: 0.625rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--color-text-muted);
    margin-bottom: 0.375rem;
  }

  .featured-grid .product-card__title {
    font-size: 1rem;
    font-weight: 600;
    margin: 0 0 0.375rem;
    line-height: 1.3;
  }

  .featured-grid .product-card__notes {
    font-size: 0.75rem;
    color: var(--color-text-light);
    margin: 0 0 0.75rem;
  }

  .featured-grid .product-card__footer {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .featured-grid .product-card__price {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--color-primary);
  }

  .featured-grid .product-card__price-period {
    font-size: 0.875rem;
    font-weight: 400;
    color: var(--color-text-light);
  }

  .featured-grid .product-card__add-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
    padding: 0.875rem;
    font-size: 0.8125rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: white;
    background: var(--color-primary);
    border: none;
    border-top: 1px solid var(--color-border);
    cursor: pointer;
    transition: background-color 0.2s;
  }

  .featured-grid .product-card__add-btn:hover {
    background: #333;
  }

  .featured-grid .product-card__add-btn svg {
    width: 16px;
    height: 16px;
  }
</style>

{% schema %}
{
  "name": "Featured Collection",
  "tag": "section",
  "class": "featured-collection-section",
  "settings": [
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow text",
      "default": "The Collection"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "10 Exclusive Fragrances"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Curated from the world's most prestigious perfume houses. Each scent tells a story of luxury and craftsmanship."
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Products to show",
      "min": 4,
      "max": 12,
      "step": 1,
      "default": 10
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show 'View All' button",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Featured Collection"
    }
  ]
}
{% endschema %}
